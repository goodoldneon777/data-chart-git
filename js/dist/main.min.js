function toggleSulfurLock(a,b){var c=["BtlAvg","DsfStartLeco","DsfInit","DsfFinal","AimDesulf"],d=!1;if("Chem"===a)test1=$(b+" .select1").val(),testArray=[test1],elem=$(b+" .select2");else{if("ChemDiff"!==a)return!1;test1=$(b+" .select1").val(),test2=$(b+" .select2").val(),testArray=[test1,test2],elem=$(b+" .select3")}return $.each(testArray,function(a,b){-1!==jQuery.inArray(b,c)&&(d=!0)}),d?(elem.val("S"),elem.prop("disabled",!0)):elem.prop("disabled",!1),d}function getDefinitions(a,b,c){"use strict";var d={sql:{}};switch(d.sql.centralTable="bop_ht",d.sql.centralDB="USSGLW.dbo",d.sql.centralTableHeat="ht_num",d.sql.centralTableDate="tap_st_dt",d.sql.joinKeyArray=["ht_num","tap_yr"],null===b&&(b=["","","","",""]),null===c&&(c=["","","","",""]),a){case"Chem":var e=b[0],f=b[1];switch(d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),e){case"BtlAvg":f="S",d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.sql.field="dslf_avg_btl_S",d.sql.table="bop_ht";break;case"DsfStartLeco":f="S",d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.sql.field="S_pct",d.sql.table="bop_ht_leco",d.sql.filterLocal="  and test_typ='IS'";break;case"DsfInit":f="S",d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.sql.field="dslf_init_S",d.sql.table="bop_ht";break;case"DsfFinal":f="S",d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.sql.field="dslf_S_after_cycle",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" < 0.050";break;case"AimDesulf":f="S",d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.sql.field="dslf_calc_aim_S",d.sql.table="bop_ht";break;case"AimBOP":d.sql.field="mdl_aim_pct",d.sql.table="bop_chem_rec",d.sql.db="Alloy_Model.dbo",d.sql.filterLocal="  and fac_id not like '%S' \n  and fac_id not like '%T' \n  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"' \n  and mdl_run_seq_num = ( \n    select max(mdl_run_seq_num) \n    from Alloy_Model.dbo.bop_chem_rec as f \n    where f.ht_num = bop_chem_rec.ht_num \n      and f.tap_yr = bop_chem_rec.tap_yr \n  )";break;case"MinRef":d.sql.field="min_pct",d.sql.table="ht_ref_chem_mod",d.sql.filterLocal="  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"'";break;case"MaxRef":d.sql.field="max_pct",d.sql.table="ht_ref_chem_mod",d.sql.filterLocal="  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"'";break;case"StartBOP":d.sql.field="mdl_start_pct",d.sql.table="bop_chem_rec",d.sql.db="Alloy_Model.dbo",d.sql.filterLocal="  and fac_id not like '%S' \n  and fac_id not like '%T' \n  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"' \n  and mdl_run_seq_num = ( \n    select max(mdl_run_seq_num) \n    from Alloy_Model.dbo.bop_chem_rec as f \n    where f.ht_num = bop_chem_rec.ht_num \n      and f.tap_yr = bop_chem_rec.tap_yr \n  )";break;case"FinalBOP":d.sql.field="pred_final_pct",d.sql.table="bop_chem_rec",d.sql.db="Alloy_Model.dbo",d.sql.filterLocal="  and fac_id not like '%S' \n  and fac_id not like '%T' \n  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"' \n  and mdl_run_seq_num = ( \n    select max(mdl_run_seq_num) \n    from Alloy_Model.dbo.bop_chem_rec as f \n    where f.ht_num = bop_chem_rec.ht_num \n      and f.tap_yr = bop_chem_rec.tap_yr \n  )";break;case"AimAr":d.sql.field="mdl_aim_pct",d.sql.table="ars_chem_rec",d.sql.db="Alloy_Model.dbo",d.sql.filterLocal="  and fac_id not like '%S' \n  and fac_id not like '%T' \n  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"' \n  and mdl_run_seq_num = ( \n    select max(mdl_run_seq_num) \n    from Alloy_Model.dbo.bop_chem_rec as f \n    where f.ht_num = bop_chem_rec.ht_num \n      and f.tap_yr = bop_chem_rec.tap_yr \n  )";break;default:d.sql.field="elem_pct",d.sql.table="ms_ht_chem_samp_anal",d.sql.filterLocal="  and test_id like '"+e+"' \n  and elem_cd = '"+f.fieldWrapDelete().toUpperCase()+"' "}d.sql.idFull=(a+" "+e+" "+f).fieldWrapAdd(),d.title=a+" "+f+": "+c[0],d.unit="%",d.format=".4f",d.decimals=4;break;case"ChemDiff":var g=b[0],h=b[1],f=b[2];d.sql.idFull=(a+" "+g+" "+h+" "+f).fieldWrapAdd(),d.title=a+" "+c[2]+": "+c[0]+" - "+c[1],d.unit="%",d.format=".4f",d.decimals=4,d.sql.field=("Chem "+g+" "+f.toUpperCase()).fieldWrapAdd()+" - "+("Chem "+h+" "+f.toUpperCase()).fieldWrapAdd();break;case"SlagChem":var f=b[0],i=c[0];d.sql.idFull=(a+" "+f).fieldWrapAdd(),d.title=a+" "+i,d.unit="%",d.format=".2f",d.decimals=2,d.sql.field=f,d.sql.table="bop_ht_slag_chem";break;case"BOPFurnaceAdd":var j=b[0];switch(d.sql.table="bop_ht_chrg_mdl_data",j){case"TotalChargeActual":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_chrg_tons * 2000 \n   else tot_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"MetalActual":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_hm_chrg_tons * 2000 \n   else tot_hm_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"ScrapActual":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_scrap_chrg_tons * 2000 \n   else tot_scrap_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"MiscActual":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_misc_tons * 2000 \n   else tot_misc_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"MetalPctActual":d.sql.field="hm_pct",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"ScrapPctActual":d.sql.field="scrap_pct",d.sql.filterLocal="  and last_calc_flg = 'O'";break;case"TotalChargeModel":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_chrg_tons * 2000 \n   else tot_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'P'";break;case"MetalModel":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_hm_chrg_tons * 2000 \n   else tot_hm_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'P'";break;case"ScrapModel":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_scrap_chrg_tons * 2000 \n   else tot_scrap_chrg_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'P'";break;case"MiscModel":d.sql.field="case \n   when calc_dt < '4/1/2014' then tot_misc_tons * 2000 \n   else tot_misc_tons * 1000 \n end ",d.sql.filterLocal="  and last_calc_flg = 'P'";break;case"MetalPctModel":d.sql.field="hm_pct",d.sql.filterLocal="  and last_calc_flg = 'P'";break;case"ScrapPctModel":d.sql.field="scrap_pct",d.sql.filterLocal="  and last_calc_flg = 'P'"}d.sql.idFull=(a+" "+j).fieldWrapAdd(),d.title=a+": "+c[0],d.unit="lb",d.sql.joinType="left outer join";break;case"BOPLadleAdd":var k=b[0];d.sql.idFull=(a+" "+k).fieldWrapAdd(),d.title=a+" "+c[0],d.unit="lb",d.sql.field="act_wt",d.sql.table="bop_ht_mat_add",d.sql.filterLocal="  and mat_cd = '"+k+"'",d.sql.joinType="left outer join";break;case"BOPScrap":var k=b[0];d.sql.idFull=(a+" "+k).fieldWrapAdd(),d.title=a+" "+c[0],d.unit="lb",d.sql.field="act_wt",d.sql.table="bop_ht_scrap_add",d.sql.filterLocal="  and scrp_cd = '"+k+"'",d.sql.joinType="left outer join";break;case"Temp":var e=b[0];switch(d.title=a+" "+c[0],d.unit="°F",d.sql.idFull=(a+" "+e).fieldWrapAdd(),e){case"HMLadle":d.sql.field="hm_ldl_act_tp",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" > 2000 ";break;case"Tap":d.sql.field="tap_tp",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"TOL":d.sql.field="TOL_tp",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"ArArrive":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'A' \n  and samp_designation = 'ARV' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"ArLeave":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'A' \n  and samp_designation = 'LV' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"RHArrive":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'ARV' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"RHDeox":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'DX' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"RHLeave":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'LV' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"CT1":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'C' \n  and samp_designation = 'CT1' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"CT2":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'C' \n  and samp_designation = 'CT2' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"CT3":d.sql.field="samp_tp",d.sql.table="ms_heat_celox",d.sql.filterLocal="  and fac_id = 'C' \n  and samp_designation = 'CT3' ",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"AimMelter":d.sql.field="melter_aim_tap_tp",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" > 2800 ";break;case"AimCharge":d.sql.field="mdl_aim_tap_tp",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" > 2800 "}break;case"TempDiff":var g=b[0],h=b[1];d.sql.idFull=(a+" "+g+" "+h).fieldWrapAdd(),d.title=a+": "+c[0]+" - "+c[1],d.unit="°F",d.sql.field=("Temp "+g).fieldWrapAdd()+" - "+("Temp "+h).fieldWrapAdd();break;case"Celox":var e=b[0];switch(d.title=a+" "+c[0],d.unit="ppm",d.sql.field="samp_oxy",d.sql.table="ms_heat_celox",d.sql.idFull=(a+" "+e).fieldWrapAdd(),e){case"TapO2":d.sql.field="tap_oxy",d.sql.table="bop_ht",d.sql.filterRealistic=d.sql.idFull+" between 1 and 1600 ";break;case"BTO":d.sql.filterLocal="  and fac_id = 'B' \n  and samp_designation = 'BTO' ",d.sql.filterRealistic=d.sql.idFull+" > 0 ";break;case"ArArrive":d.format=".1f",d.decimals=1,d.sql.field="samp_oxy_dec",d.sql.filterLocal="  and fac_id = 'A' \n  and samp_designation = 'ARV' ",d.sql.filterRealistic=d.sql.idFull+" between 0.1 and 100 ";break;case"ArLeave":d.format=".1f",d.decimals=1,d.sql.field="samp_oxy_dec",d.sql.filterLocal="  and fac_id = 'A' \n  and samp_designation = 'LV' ",d.sql.filterRealistic=d.sql.idFull+" between 0.1 and 100 ";break;case"RHArrive":d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'ARV' ",d.sql.filterRealistic=d.sql.idFull+" > 0 ";break;case"RHDeox":d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'DX' ",d.sql.filterRealistic=d.sql.idFull+" > 0 ";break;case"RHLeave":d.sql.filterLocal="  and fac_id = 'V' \n  and samp_designation = 'LV' ",d.sql.filterRealistic=d.sql.idFull+" > 0 "}break;case"TapDTS":d.sql.idFull=a.fieldWrapAdd(),d.title="Tap DTS",d.type="datetime",d.format="%m/%d/%Y",d.sql.field="tap_st_dt",d.sql.table="bop_ht";break;case"BOPmisc":var l=b[0];switch(l){case"Mg90":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Mg90",d.unit="lbs",d.sql.field="dslf_act_Mg90_wt",d.sql.table="bop_ht";break;case"Mg90Replunge":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Mg90 Replunge",d.unit="lbs",d.sql.field="dslf_act_rplng_Mg90_wt",d.sql.table="bop_ht";break;case"DsfSkimCrane":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Desulf Skim (Crane)",d.unit="lbs",d.sql.field="hm_skim_loss_wt",d.sql.table="bop_ht",d.sql.filterLocal="  and hm_skim_loss_wt_typ = 'C' ";break;case"DsfSkimCalc":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Desulf Skim (Calc)",d.unit="lbs",d.sql.field="hm_skim_loss_wt",d.sql.table="bop_ht",d.sql.filterLocal="  and hm_skim_loss_wt_typ = 'P' ";break;case"RecycleWt":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Recycled Steel",d.unit="lbs",d.sql.field="recycled_wt",d.sql.table="bop_recycled_ht",d.sql.joinType="left outer join";break;case"TotalN2Cool":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Total N2 Cool Time",d.unit="seconds",d.sql.selectDistinct=!0,d.sql.field="sum(cool_dur_sec) over(partition by ht_num, tap_yr)",d.sql.table="bop_ht_coolant",d.sql.joinType="left outer join";break;case"TapDur":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Tap Duration",d.unit="minutes",d.format=".1f",d.decimals=1,d.sql.field="tap_dur",d.sql.table="bop_ht"}break;case"DegasserMisc":var l=b[0];switch(l){case"RHSlagDepth":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Slag Depth",d.unit="inches",d.sql.field="meas_slag_dpth",d.sql.table="degas_ht";break;case"RHFreeboard":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Freeboard",d.unit="inches",d.sql.field="freeboard",d.sql.table="degas_ht";break;case"DecarbTime":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Decarb Time",d.unit="minutes",d.format=".1f",d.decimals=1,d.sql.field="convert( \n  decimal(10, 1), \n  datediff( \n    second, \n    max( \n      case when evt_name like 'CIRC CONFIRMED%' then evt_dt end \n    ) over(partition by ht_num, tap_yr, deg_ht_sufx), \n    max( \n      case when evt_name like 'DEOX START%' then evt_dt end \n    ) over(partition by ht_num, tap_yr, deg_ht_sufx) \n  )/60.0 \n)",d.sql.table="degas_ht_event",d.sql.filterLocal="  and( \n    evt_name like 'CIRC CONFIRMED%' \n    or evt_name like 'DEOX START%' \n  )";break;case"RHFinalStir":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Final Stir Time",d.unit="heats",d.sql.field="fin_stir_time",d.sql.table="degas_ht";break;case"RHHtsOnSnorkel":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Heats On Snorkel",d.unit="heats",d.sql.field="num_hts_on",d.sql.table="degas_ht_equip_usage",d.sql.filterLocal="  and degas_ht_equip_usage.equip_cd = 'UPSNKL' ";break;case"ChemTestCount":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Chem Test Count",d.unit="tests",d.sql.selectDistinct=!0,d.sql.field="count(test_id) over (partition by ht_num, tap_yr)",d.sql.table="ms_ht_chem_samp_anal",d.sql.filterLocal="  and test_id like 'V%' \n  and elem_cd = 'C'";break;case"TreatmentCount":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="RH Treatment Count",d.unit="treatments",d.sql.selectDistinct=!0,d.sql.field="count(deg_ht_sufx) over(partition by ht_num, tap_yr)",d.sql.table="degas_ht"}break;case"ArgonLadleAdd":var m=b[0],k=b[1];d.sql.idFull=(a+" "+m+" "+k).fieldWrapAdd(),d.unit="lb",d.sql.field="act_wt",d.sql.fromOverride="select distinct \n  ht_num, tap_yr, stir_cnt, sum(isNull(act_wt, 0)) over(partition by ht_num, tap_yr) as act_wt \nfrom( \n  select distinct \n    ht_num, tap_yr, stir_cnt, max(stir_cnt) over(partition by ht_num, tap_yr) as stir_cnt_final \n  from USSGLW.dbo.argon_ht_stir \n) sub1 \nleft outer join( \n  select \n    ht_num as ht_num_sub2, tap_yr as tap_yr_sub2, stir_cnt as stir_cnt_sub2, mat_cd, act_wt \n  from USSGLW.dbo.argon_ht_mat_add \n  where \n    mat_cd = '"+k+"' \n) sub2 \n  on sub1.ht_num = sub2.ht_num_sub2 \n    and sub1.tap_yr = sub2.tap_yr_sub2 \n    and sub1.stir_cnt = sub2.stir_cnt_sub2 \n","AllStirs"===m?d.title="Argon "+c[1]:"After1"===m?(d.title="Argon "+c[1]+" After Stir1",d.sql.fromOverride+="where stir_cnt > '1' \n"):"Final"===m?(d.title="Argon "+c[1]+" On Final Stir",d.sql.fromOverride+="where stir_cnt = stir_cnt_final \n"):(d.title="Argon Stir "+c[1]+" On Stir"+m,d.sql.fromOverride+="where stir_cnt = '"+m+"' \n"),d.sql.fromOverride=indentString(d.sql.fromOverride,"  ");break;case"ArgonStir":var m=b[0],l=b[1];d.sql.idFull=(a+" "+m+" "+l).fieldWrapAdd(),d.unit="minutes",d.format=".1f",d.decimals=1,d.sql.selectDistinct=!0,d.sql.field="convert(decimal(10, 1), sum(stir_dur) over(partition by ht_num, tap_yr))",d.sql.fromOverride="select distinct \n  ht_num, tap_yr, stir_cnt, \n  max(stir_cnt) over(partition by ht_num, tap_yr) as stir_cnt_final, \n  datediff(second, stir_st_dt, stir_end_dt)/60.0 as stir_dur \nfrom USSGLW.dbo.argon_ht_stir argon_ht_stir \n","AllStirs"===m?d.title="Argon "+c[1]:"After1"===m?(d.title="Argon "+c[1]+" After Stir1",d.sql.fromOverride+="where stir_cnt > '1' \n"):"Final"===m?(d.title="Argon "+c[1]+" On Final Stir",d.sql.filterLocal="  and stir_cnt = stir_cnt_final \n"):(d.title="Argon Stir "+c[1]+" On Stir"+m,d.sql.fromOverride+="where stir_cnt = '"+m+"' \n"),d.sql.fromOverride=indentString(d.sql.fromOverride,"  "),d.sql.filterRealistic=d.sql.idFull+" > 0 ";break;case"ArgonMisc":var l=b[0];switch(d.type="linear",l){case"TotalStir":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Argon Total Stir",d.unit="minutes",d.format=".1f",d.decimals=1,d.sql.field="convert(decimal(10,1), cum_stir_time)",d.sql.table="argon_ht";break;case"ChemTestCount":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Ar Chem Test Count",d.unit="tests",d.sql.selectDistinct=!0,d.sql.field="count(test_id) over (partition by ht_num, tap_yr)",d.sql.table="ms_ht_chem_samp_anal",d.sql.filterLocal="  and test_id like 'A_L_' \n  and elem_cd = 'C'";break;case"StirCount":d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Argon Stir Count",d.unit="stirs",d.sql.selectDistinct=!0,d.sql.field="max(stir_cnt) over (partition by ht_num, tap_yr)",d.sql.table="argon_ht_stir";break;case"AlLoss":var n="ChemDiff A_L1 A_L2 Al".fieldWrapAdd(),o="ArgonLadleAdd After1 ALUM".fieldWrapAdd();d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Al Loss (L1 to L2 Tests)",d.unit="lbs",d.sql.selectDistinct=!0,d.sql.field=n+" * 5000 + "+o}break;case"CCMisc":var l=b[0];switch(d.type="linear",l){case"HeatOfCast":var l=b[0];d.sql.idFull=(a+" "+l).fieldWrapAdd(),d.title="Heat Of Cast",d.type="text",d.sql.field="cast_ht_seq_num",d.sql.table="cast_ht"}break;case"ScrapYard":var p=b[0];d.sql.idFull=(a+" "+p).fieldWrapAdd(),d.title=a,d.type="text",d.sql.field="box_1_scale",d.sql.table="bop_ht_scrp_chrg",d.sql.filterLocal="  and box_1_scale = '"+p+"'",d.disableOperator=!0;break;case"BOPVessel":var q=b[0];d.sql.idFull=(a+" "+q).fieldWrapAdd(),d.title="BOP Vessel",d.type="text",d.sql.field="null",d.sql.table="bop_ht",d.sql.filterLocal="  and substring(ht_num, 1, 2) = '"+q+"' ",d.disableOperator=!0;break;case"RHVessel":var q=b[0];d.sql.idFull=(a+" "+q).fieldWrapAdd(),d.title="RH Vessel",d.type="text",d.sql.field="active_ves",d.sql.table="degas_ht",d.sql.filterLocal="  and "+d.sql.field+" = '"+q+"' ",d.disableOperator=!0;break;case"ArStation":var r=b[0];d.sql.idFull=(a+" "+r).fieldWrapAdd(),d.title="Argon Station",d.type="text",d.sql.field="Ar_stat_num",d.sql.table="argon_ht",d.sql.filterLocal="  and "+d.sql.field+" = '"+r+"' ",d.disableOperator=!0;break;case"CasterNumber":var s=b[0];d.sql.idFull=(a+" "+s).fieldWrapAdd(),d.title="Caster",d.type="text",d.sql.field="caster_num",d.sql.table="cast_ht",d.sql.filterLocal="  and "+d.sql.field+" = '"+s+"' ",d.disableOperator=!0;break;case"LadleNumber":d.sql.idFull=(a+" "+s).fieldWrapAdd(),d.title="Ladle",d.type="text",d.sql.field="ldl_num",d.sql.table="bop_ht",d.equalOperatorOnly=!0}return void 0===d.type?d.type="linear":null,void 0===d.unit?d.unit="":null,void 0===d.format?d.format=".f":null,void 0===d.decimals?d.decimals=0:null,void 0===d.sql.field?d.sql.field="":null,void 0===d.sql.table?d.sql.table="":null,void 0===d.sql.db?d.sql.db="USSGLW.dbo":null,void 0===d.sql.filterLocal?d.sql.filterLocal="":d.sql.filterLocal+=" \n",void 0===d.sql.filterRealistic?d.sql.filterRealistic="":d.sql.filterRealistic+=" \n",void 0===d.sql.joinType?d.sql.joinType="inner join":null,void 0===d.sql.selectDistinct?d.sql.selectDistinct=!1:null,void 0===d.sql.fromOverride?d.sql.fromOverride=!1:null,void 0===d.disableOperator?d.disableOperator=!1:null,void 0===d.equalOperatorOnly?d.equalOperatorOnly=!1:null,d}function nullIfBlank(a){"use strict";return""===a?null:a}function getUrlParameter(a){"use strict";for(var b=window.location.search.substring(1),c=b.split("&"),d=null,e=0;e<c.length;e++){var f=c[e].split("=");if(f[0]===a){d=f[1];break}}return void 0===d&&(d=null),d}function indentString(a,b){"use strict";if(""===a)return a;var c=a.split("\n");return a="",1===c.length?a=b+c[0]+"\n":$.each(c,function(d,e){d<c.length-1&&(a+=b+e+"\n")}),a}function fieldExpandCreate(a,b){"use strict";function c(b,c){var d=$(b),e=null;return d.empty(),$.each(c,function(b,c){$.isArray(c)?(a=c[0],e=c[1]):a=e=c,d.append($("<option></option>").attr("value",a).text(e))}),d.show(),!0}var d="";$(b+" .fieldExpand span").hide(),$(b+" .fieldExpand select").hide();var e=[["BLAD","BLAD"],["ILAD","ILAD"],["BtlAvg","HM Bottle Average"],["DsfStartLeco","Desulf Initial (Leco)"],["DsfInit","Desulf Initial"],["DsfFinal","Desulf Final"],["B_F1","TD"],["B_L1","TOL"],["A_L1","Ar 1st"],["A_L2","Ar 2nd"],["V_L1","RH 1st"],["V_L2","RH 2nd"],["L_L1","LMF 1st"],["L_L2","LMF 2nd"],["C_M1","CC M1"],["C_M2","CC M2"],["C_M3","CC M3"],["MinRef","Min (Final Ref)"],["MaxRef","Max (Final Ref)"],["AimDesulf","Aim (Desulf)"],["AimBOP","Aim (BOP)"],["StartBOP","Pre-Alloy Pred (BOP)"],["FinalBOP","TOL Pred (BOP)"],["AimAr","Aim (Argon)"]],f=["C","Mn","P","S","Si","Cu","Ni","Cr","Mo","Sn","Al","V","Cb","Ti","B","N","Ca","As","Sb","ExTi"],g=[["FeO_pct","FeO"],["Vratio","Vratio"],["CaO_pct","CaO"],["SiO2_pct","SiO2"],["MgO_pct","MgO"],["MnO_pct","MnO"],["P2O5_pct","P2O5"],["S_pct","S"],["Al2O3_pct","Al2O3"],["TiO2_pct","TiO2"]],h=[["HMLadle","HM Ladle"],["Tap","Tap"],["TOL","TOL"],["ArArrive","Ar Arrive"],["ArLeave","Ar Leave"],["RHArrive","RH Arrive"],["RHDeox","RH Deox"],["RHLeave","RH Leave"],["CT1","CC Tundish 1"],["CT2","CC Tundish 2"],["CT3","CC Tundish 3"],["AimMelter","Aim Melter"],["AimCharge","Aim Charge Model"]],i=[["TapO2","BOP Tap O2"],["BTO","BOP BTO"],["ArArrive","Ar Arrive"],["ArLeave","Ar Leave"],["RHArrive","RH Arrive"],["RHDeox","RH Deox"],["RHLeave","RH Leave"]],j=[["TotalChargeActual","Total Charge"],["MetalActual","Metal Charge"],["ScrapActual","Scrap Charge"],["MiscActual","Misc Charge"],["MetalPctActual","Metal Percent"],["ScrapPctActual","Scrap Percent"],["TotalChargeModel","Total Charge (Model)"],["MetalModel","Metal Charge (Model)"],["ScrapModel","Scrap Charge (Model)"],["MiscModel","Misc Charge (Model)"],["MetalPctModel","Metal Percent (Model)"],["ScrapPctModel","Scrap Percent (Model)"]],k=[["05","Reg FeMn"],["12","MC FeMn"],["13","Al Notch Bar"],["55","Al Cones"],["81","Coke"],["CS","Coke Super Sack"],["15","75% FeSi"],["62","FeB"],["26","FeCb"],["95","FeTi"],["24","FeP"],["43","Slag Cond 70%"],["97","Ladle Desulf"]],l=[["FAB","1 Bundles"],["FAF","Home"],["FAS","Pit + BF Iron"],["FBE","Cut Slabs"],["FFR","Frag"],["FHS","P&S"],["FOH","1.5 Bundles"],["FRB","HMS Demo + Bello Briqs"],["FST","Side Trim"],["FTC","Tin Can"],["FTU","Tundish"]],m=[["Mg90","Desulf Mg90"],["Mg90Replunge","Desulf Mg90 (Replunge)"],["DsfSkimCrane","Desulf Skim (Crane)"],["DsfSkimCalc","Desulf Skim (Calc)"],["RecycleWt","Recycled Steel Weight"],["TotalN2Cool","Total N2 Cool Time"],["TapDur","Tap Duration"]],n=[["RHSlagDepth","Slag Depth"],["RHFreeboard","Freeboard"],["DecarbTime","Decarb Time"],["RHFinalStir","Final Stir Time"],["RHHtsOnSnorkel","Heats on Snorkel"],["ChemTestCount","Chem Test Count"],["TreatmentCount","Treatment Count"]],o=[["ALUM","Aluminum"],["SCRAP","Scrap"],["CWIRE","Carbon Wire"],["COAL","Coal"],["MC-MN","Manganese (MC)"],["COLUM","Columbium"],["FE-CR","Chromium"],["CALSI","CalSil"],["FSILI","Silicon"],["BIMAC","BIMAC"],["BORON","Boron"],["FE-TI","Titanium"],["VANAD","Vanadium"],["PHOS","Phosphorus"],["PYRIT","Pyrite"],["SULFU","Sulfur"]],p=[["AllStirs","Total All Stirs"],["After1","Total After Stir 1"],["Final","Final Stir"],["1","Stir 1"],["2","Stir 2"],["3","Stir 3"],["4","Stir 4"],["5","Stir 5"],["6","Stir 6"],["7","Stir 7"],["8","Stir 8"]],q=[["Duration","Duration"]],r=[["TotalStir","Total Stir"],["ChemTestCount","Chem Test Count"],["StirCount","Stir Count"],["AlLoss","Alum Loss (L1 to L2)"]],s=[["HeatOfCast","Heat of Cast"]],t=[["E","East"],["W","West"]],u=["25","26"],v=["1","2"],w=["1","2"],x=["1","2"];switch(a){case"Chem":c(b+" .select1",e),c(b+" .select2",f);break;case"ChemDiff":$(b+" .message").html("&nbsp;(top minus bottom)"),$(b+" .message").show(),c(b+" .select1",e),c(b+" .select2",e),c(b+" .select3",f);break;case"SlagChem":c(b+" .select1",g);break;case"Temp":c(b+" .select1",h);break;case"TempDiff":$(b+" .message").html("&nbsp;(top minus bottom)"),$(b+" .message").show(),c(b+" .select1",h),c(b+" .select2",h);break;case"Celox":c(b+" .select1",i);break;case"BOPFurnaceAdd":c(b+" .select1",j);break;case"BOPLadleAdd":c(b+" .select1",k);break;case"BOPScrap":c(b+" .select1",l);break;case"BOPmisc":c(b+" .select1",m);break;case"DegasserMisc":c(b+" .select1",n);break;case"ArgonLadleAdd":c(b+" .select1",p),c(b+" .select2",o);break;case"ArgonStir":c(b+" .select1",p),c(b+" .select2",q);break;case"ArgonMisc":c(b+" .select1",r);break;case"CCMisc":c(b+" .select1",s);break;case"ScrapYard":c(b+" .select1",t);break;case"BOPVessel":c(b+" .select1",u);break;case"RHVessel":c(b+" .select1",v);break;case"ArStation":c(b+" .select1",w);break;case"CasterNumber":c(b+" .select1",x)}return d}var mMaster={sql:{},x:{target:"#options-x",sql:{subName:"subX"}},y:{target:"#options-y",sql:{subName:"subY"}},moreFilters:{eachFilter:[],sql:{}}},mSQL={},mOptions={},mUpdateAxes={},mUpdateSeries={},mMoreFilters={},mChart={};$(document).ready(function(){mOptions.init(),mUpdateAxes.start(),mUpdateSeries.start(),mMoreFilters.init()}),mMaster.submitHandle=function(){"use strict";var a,b;return a=b="",g.error=!1,mOptions.validate(),mMoreFilters.validate(),g.error===!0?(mOptions.toggleSubmitBtn("enable"),!1):(mMaster.prepareModuleOptions(),mMaster.prepareModuleMoreFilters(),mMaster.sql.mainQuery=mSQL.mainQueryBuild(mMaster),a=mMaster.sql.mainQuery,b=mMaster.x.type,mSQL.runQuery(a,b),!0)},mMaster.prepareModuleMoreFilters=function(){"use strict";function a(){function a(a){var b=a.sql.subName,c=a.sql.idFull,d=a.operator,e=$(a.target+" .input1").val(),f=$(a.target+" .input2").val(),g=a.sql.joinType,h="";return a.disableOperator===!1&&(h=mSQL.createSingleFilter(b,c,d,e,f,g)),h}$.each(mMoreFilters.eachFilter,function(b,c){mMoreFilters.eachFilter[b].sql.filter=a(c)})}function b(){var a={};$.each(mMoreFilters.eachFilter,function(b,c){a=mSQL.subQueryBuild(c.sql.idFull,mMaster.sql.filterGlobal),mMoreFilters.eachFilter[b].sql.query=a.sql.query})}mMoreFilters.getFromDOM(),a(),b(),mMaster.moreFilters=mMoreFilters},mMaster.prepareModuleOptions=function(){"use strict";function a(){function a(a){var b=a.sql.subName,c=a.sql.idFull,d=null,e=$(a.target+" .min").val(),f=$(a.target+" .max").val(),g=a.sql.joinType,h=mSQL.createSingleFilter(b,c,d,e,f,g);return h}var b=mMaster.x.sql.centralTable,c=mMaster.x.sql.centralTableDate,d=mMaster.timeMin,e=mMaster.timeMax;mMaster.x.sql.filter=a(mMaster.x),mMaster.y.sql.filter=a(mMaster.y),mMaster.sql.filterDate=mSQL.createSingleFilter(b,c,null,d,e,null);var f=d.substr(d.length-2);mMaster.sql.filterGlobal="tap_yr >= '"+f+"' \n",mMaster.tapGrade?mMaster.sql.filterGrade="tap_grd like '"+mMaster.tapGrade+"' \n":mMaster.sql.filterGrade=""}function b(){var a={};a=mSQL.subQueryBuild(mMaster.x.sql.idFull,mMaster.sql.filterGlobal),mMaster.x.sql=$.extend(!0,{},mMaster.x.sql,a.sql),a=mSQL.subQueryBuild(mMaster.y.sql.idFull,mMaster.sql.filterGlobal),mMaster.y.sql=$.extend(!0,{},mMaster.y.sql,a.sql)}return $.extend(mMaster,mOptions.getFromDOM()),a(),b(),!0},mMaster.createSubQueries=function(){var a={};a=mSQL.subQueryBuild(mMaster.x.sql.idFull,mMaster.sql.filterGlobal),mMaster.x.sql=$.extend(!0,{},mMaster.x.sql,a.sql),a=mSQL.subQueryBuild(mMaster.y.sql.idFull,mMaster.sql.filterGlobal),mMaster.y.sql=$.extend(!0,{},mMaster.y.sql,a.sql)},mMaster.createOptionsFilters=function(a){function b(a){var b=a.sql.subName,c=a.sql.idFull,d=null,e=$(a.target+" .min").val(),f=$(a.target+" .max").val(),g=a.sql.joinType,h=mSQL.createSingleFilter(b,c,d,e,f,g);return h}var c=mMaster.x.sql.centralTable,d=mMaster.x.sql.centralTableDate,e=mMaster.timeMin,f=mMaster.timeMax;mMaster.x.sql.filter=b(mMaster.x),mMaster.y.sql.filter=b(mMaster.y),mMaster.sql.filterDate=mSQL.createSingleFilter(c,d,null,e,f,null);var g=e.substr(e.length-2);mMaster.sql.filterGlobal="tap_yr >= '"+g+"' \n"},mMaster.queryResultsHandle=function(a,b){function c(a,b){var c,d,e,f,g,h,i,j=[];c=d=e=f=g=h=i="";var k={heats:[],averages:[]};return $.each(a,function(l,m){j=[],l>0&&(j=a[l-1]),"datetime"===b?(c=Date.parse(m[0]),f=Date.parse(m[3])):(c=parseFloat(m[0],4),f=parseFloat(m[3],4)),d=parseFloat(m[1],4),e=m[2],g=parseFloat(m[4],4),h=m[5],i=parseFloat(m[6],1),k.heats.push({x:c,y:d,info:e}),$.isNumeric(f)&&(0===l?k.averages.push({x:f,y:g,info1:h,info2:i}):(m[3]!==j[3]||m[4]!==j[4])&&k.averages.push({x:f,y:g,info1:h,info2:i}))}),k}var d={};d=c(a,b),mChart.display(d,mMaster)},mChart.display=function(a,b){$(function(){$("#m-graph").highcharts({chart:{type:"scatter",animation:!1,zoomType:"xy"},credits:{enabled:!1},exporting:{enabled:!1},title:{text:"["+b.y.title+"] vs ["+b.x.title+"]"},xAxis:{type:b.x.type,title:{text:b.x.title+" ("+b.x.unit+")"},labels:{format:"{value:"+b.x.format+"}"}},yAxis:{title:{text:b.y.title+" ("+b.y.unit+")"},labels:{format:"{value:"+b.y.format+"}"}},tooltip:{snap:1,headerFormat:"<b>{series.name}</b><br>",formatter:function(){if("datetime"===b.x.type){var a="y: "+Highcharts.numberFormat(this.point.y,b.y.decimals,".",",")+" "+b.y.unit+"<br>";"Heats"===this.series.name?(a+="x: "+Highcharts.dateFormat("%m/%d/%Y %I:%M",this.point.x)+"<br>",a+="Heat ID: "+this.point.info):"Average"===this.series.name.substring(0,7)&&(a+="x: "+Highcharts.dateFormat(b.x.format,this.point.x)+" (nearest "+b.x.round+") <br>",a+="Heat Count: "+this.point.info1+" <br>",a+="Std Dev: "+Highcharts.numberFormat(this.point.info2,b.y.decimals+1))}else{var a="y: "+Highcharts.numberFormat(this.point.y,b.y.decimals)+" "+b.y.unit+"<br>";"Heats"===this.series.name?(a+="x: "+Highcharts.numberFormat(this.point.x,b.x.decimals)+" "+b.x.unit+"<br>",a+="Heat ID: "+this.point.info):"Average"===this.series.name.substring(0,7)&&(a+="x: "+Highcharts.numberFormat(this.point.x,b.x.decimals)+" "+b.x.unit+" (nearest "+b.x.round+") <br>",a+="Heat Count: "+this.point.info1+" <br>",a+="Std Dev: "+Highcharts.numberFormat(this.point.info2,b.y.decimals+1))}return a}},plotOptions:{spline:{marker:{enabled:!0}},series:{turboThreshold:g.maxRows}},line:{visible:!1},series:[{name:"Heats",color:"rgba(79,129,189,0.4)",data:a.heats,stickyTracking:!1,regression:!1,regressionSettings:{type:"linear",color:"rgba(0, 0, 0, 0.8)"}},{name:"Average (nearest "+b.x.round+")",color:"rgba(192,80,77,1.0)",marker:{radius:8,symbol:"circle"},data:a.averages}]})})},String.prototype.fieldWrapDelete=function(){"use strict";if("linux"===s.OS){var a=this.replace(/\[/g,"");return a=a.replace(/\]/g,"")}return"windows"===s.OS?this.replace(/\"/g,""):void 0},String.prototype.fieldWrapAdd=function(){"use strict";return"linux"===s.OS?"["+this+"]":"windows"===s.OS?'"'+this+'"':void 0},String.prototype.fieldWrapToArray=function(){"use strict";var a=[];if("linux"===s.OS)return a=this.match(/\[(.*?)\]/g),null===a?a=[]:$.each(a,function(b,c){a[b]=c}),a;if("windows"===s.OS){var b=this.split('"');return a=[],$.each(b,function(b,c){b%2>0&&a.push(c.fieldWrapAdd())}),a}};var g={};g.maxRows=2e4,g.error=!1,g.errorFunc=function(a){"use strict";g.error=!0,alert(a)},mMoreFilters.init=function(){"use strict";function a(){$("#m-moreFilters select").change(function(){mMoreFilters.update($(this))})}$("#m-moreFilters .fieldExpand span").hide(),$("#m-moreFilters .fieldExpand select").hide(),$("#m-moreFilters .operator").hide(),$("#m-moreFilters .range").children().hide(),mMoreFilters.eachFilter=[],a()},mMoreFilters.update=function(a){"use strict";var b=a.attr("class"),c="#m-moreFilters #"+$(a).closest("div").attr("id"),d=$(c+" ."+b).val(),e="",f=!1,g=!1;switch("fieldExpand"===$(a).closest("div").attr("class")&&(c="#m-moreFilters #"+a.parent().parent().attr("id")+" .fieldExpand",d=$(c+" ."+b).val(),e=$("#m-moreFilters #"+a.parent().parent().attr("id")+" .field").val(),b="fieldExpand"),b){case"field":e=d,f=getDefinitions(e,null,null).disableOperator,g=getDefinitions(e,null,null).equalOperatorOnly,$(c+" .fieldExpand select").prop("disabled",!1),"N/A"===d||f?($(c+" .operator").hide(),$(c+" .range").children().hide()):g?($(c+" .operator").show(),$(c+" .operator").val("="),$(c+" .range .input1").show(),$(c+" .range .and").hide(),$(c+" .range .input2").hide()):($(c+" .operator").show(),$(c+" .range .input1").show()),fieldExpandCreate(e,c);break;case"operator":"between"===d||"notBetween"===d?$(c+" .range").children().show():($(c+" .range .input1").show(),$(c+" .range .and").hide(),
$(c+" .range .input2").hide());break;case"fieldExpand":toggleSulfurLock(e,c)}return!0},mMoreFilters.validate=function(){"use strict";var a=$("#m-moreFilters").find("input:visible");return $.each(a,function(a,b){var c=$(b).val();if(""===c){var d="ERROR: Missing input.\n\nThere's an empty input box in the 'More Filters' section.";return g.errorFunc(d),!1}if(!$.isNumeric(c)){var d="ERROR: Invalid number.\n\nYou entered: '"+c+"'\nCorrect format: numeric.";return g.errorFunc(d),!1}}),!0},mMoreFilters.getFromDOM=function(){function a(a){var b=a.target,c=[];return a.idMain=$(b+" .field option:selected").val(),a.operator=$(b+" .operator").val(),a.paramsVal=[],a.paramsText=[],c=$(b+" .fieldExpand").find("select"),$.each(c,function(c,d){var e=$(d).attr("class"),f=$(b+" .fieldExpand ."+e+" option:selected").val(),g=$(b+" .fieldExpand ."+e+" option:selected").text();a.paramsVal.push(f),a.paramsText.push(g)}),a=$.extend(!0,{},a,getDefinitions(a.idMain,a.paramsVal,a.paramsText))}var b={};mMoreFilters.eachFilter=[],mMoreFilters.filtersAvailable=$("#m-moreFilters .item").length,mMoreFilters.filtersUsed=0;for(var c=1;c<=mMoreFilters.filtersAvailable;c++)b.target="#m-moreFilters #filter"+c,b.sql={subName:"filter"+c},"N/A"!==$(b.target+" .field").val()&&(mMoreFilters.eachFilter.push(a(b)),mMoreFilters.filtersUsed+=1);return!0},mOptions.init=function(){"use strict";function a(){$("#m-options select").change(function(){mOptions.update($(this))}),$("#generate").click(function(){mOptions.toggleSubmitBtn("disable","Loading..."),mMaster.submitHandle()})}mOptions.toggleSubmitBtn("disable","Loading..."),mOptions.x={target:"#options-x",sql:{subName:"subX"}},mOptions.y={target:"#options-y",sql:{subName:"subY"}};var b=moment().subtract(30,"days").format("M/D/YY");return $("#options-filter .dataRange .min").val(b),a(),$("#m-options #options-x .field").change(),$("#m-options #options-y .field").change(),mOptions.toggleSubmitBtn("enable"),!0},mOptions.update=function(a){"use strict";var b=a.attr("class"),c="#m-options #"+$(a).closest("div").attr("id"),d=$(c+" ."+b).val(),e=d,f=getDefinitions(e,null,null).type;switch("linear"!=f?($(c+" .min").val(""),$(c+" .max").val(""),$(c+" .dataRange").hide()):$(c+" .dataRange").show(),"fieldExpand"===$(a).closest("div").attr("class")&&(c="#m-options #"+a.parent().parent().attr("id")+" .fieldExpand",d=$(c+" ."+b).val(),e=$("#m-options #"+a.parent().parent().attr("id")+" .field").val(),b="fieldExpand"),b){case"field":e=d,$(c+" .fieldExpand select").prop("disabled",!1),"linear"!=f?($(c+" .min").val(""),$(c+" .max").val(""),$(c+" .dataRange").hide()):$(c+" .dataRange").show(),fieldExpandCreate(e,c);break;case"fieldExpand":toggleSulfurLock(e,c)}return!0},mOptions.validate=function(){function a(a){if("#options-filter"===a?(c="datetime",f=nullIfBlank($(a+" .min").val()),f||(e="ERROR: Missing minimum date.\n\nYou must enter a minimum date in the 'Time Range' section.",g.errorFunc(e))):(b=$(a+" .field option:selected").val(),c=getDefinitions(b,null,null).type),"linear"===c){if(f=nullIfBlank($(a+" .min").val()),h=nullIfBlank($(a+" .max").val()),f&&!$.isNumeric(f))return e="ERROR: Invalid number.\n\nYou entered: '"+f+"'\nCorrect format: numeric.",g.errorFunc(e),!1;if(h&&!$.isNumeric(h))return e="ERROR: Invalid number.\n\nYou entered: '"+h+"'\nCorrect format: numeric.",g.errorFunc(e),!1}else if("datetime"===c){if(f=nullIfBlank($(a+" .min").val()),h=nullIfBlank($(a+" .max").val()),f&&!Date.parse(f))return e="ERROR: Invalid date.\n\nYou entered: '"+f+"'\nCorrect format: m/d/yy. For example, 4/23/15 is properly formatted.",g.errorFunc(e),!1;if(h&&!Date.parse(h))return e="ERROR: Invalid date.\n\nYou entered: '"+h+"'\nCorrect format: m/d/yy. For example, 4/23/15 is properly formatted.",g.errorFunc(e),!1}if(d=nullIfBlank($(a+" .round input").val()),d&&"datetime"===c){if("day"!=d&&"week"!=d&&"month"!=d&&"year"!=d)return e="ERROR: Invalid rounding factor.\n\nYou entered '"+d+"'\nAcceptable options: day, week, month and year.",g.errorFunc(e),!1}else if(d&&"linear"===c&&!$.isNumeric(d))return e="ERROR: Invalid rounding factor.\n\nYou entered '"+d+"'\nAcceptable options: numeric.",g.errorFunc(e),!1;return!0}var b="",c="",d="",e="",f=null,h=null;return a("#options-x"),a("#options-y"),a("#options-filter"),!0},mOptions.getFromDOM=function(){function a(a){var c=a.target;return a.min=nullIfBlank($(c+" .min").val()),a.max=nullIfBlank($(c+" .max").val()),"#options-x"===c&&(a.round=nullIfBlank($(c+" .round input").val())),a.idMain=$(c+" .field option:selected").val(),a.paramsVal=[],a.paramsText=[],b=$(c+" .fieldExpand").find("select"),$.each(b,function(b,d){var e=$(d).attr("class"),f=$(c+" .fieldExpand ."+e+" option:selected").val(),g=$(c+" .fieldExpand ."+e+" option:selected").text();a.paramsVal.push(f),a.paramsText.push(g)}),a=$.extend(!0,{},a,getDefinitions(a.idMain,a.paramsVal,a.paramsText))}var b=[];return mOptions.x=$.extend(!0,{},mOptions.x,a(mOptions.x)),mOptions.y=$.extend(!0,{},mOptions.y,a(mOptions.y)),mOptions.timeMin=nullIfBlank($("#options-filter .dataRange .min").val()),mOptions.timeMax=nullIfBlank($("#options-filter .dataRange .max").val()),mOptions.tapGrade=nullIfBlank($("#options-filter .tapGrade input").val()),{x:mOptions.x,y:mOptions.y,timeMin:mOptions.timeMin,timeMax:mOptions.timeMax,tapGrade:mOptions.tapGrade}},mOptions.toggleSubmitBtn=function(a,b){var c="Generate Chart";switch(void 0===b&&(b=c),a){case"disable":$("#m-options #generate").prop("disabled",!0),$("#m-options #generate").val(b);break;case"enable":$("#m-options #generate").prop("disabled",!1),$("#m-options #generate").val(c)}return!0},mSQL.runQuery=function(a,b){"use strict";var c="";"windows"===s.OS?c="php/query_windows.php":"linux"===s.OS&&(c="php/query_linux.php"),$.ajax({type:"POST",url:c,data:{sql:JSON.stringify(a),type:JSON.stringify(b)},dataType:"json",success:function(c){c.data.length>g.maxRows&&alert("Too many results. Please narrow your search. \n\nResults: "+c.data.length+" heats \nMax: "+g.maxRows+" heats \n"),console.log(a),console.log(mMaster),mMaster.queryResultsHandle(c.data,b),mSQL.updateLog(mMaster,c.duration,c.user,c.ip,null),mOptions.toggleSubmitBtn("enable")},error:function(b){alert("ERROR: AJAX/PHP/SQL issue. \n\nThis error isn't your fault. Please email a screenshot of this web page to Aaron Harper at amharper@uss.com."),console.log(b.data),console.log(a),mSQL.updateLog(mMaster,null,null,null,"Y"),mOptions.toggleSubmitBtn("enable")}})},mSQL.updateLog=function(a,b,c,d,e){var f=getUrlParameter("me"),g=getUrlParameter("test"),h=getUrlParameter("log");"N"!==h&&$.ajax({type:"POST",url:"php/updateLog.php",data:{mMaster:JSON.stringify(a),duration:JSON.stringify(b),user:JSON.stringify(c),ip:JSON.stringify(d),error:JSON.stringify(e),me:JSON.stringify(f),test:JSON.stringify(g)},dataType:"json",success:function(a){},error:function(a){console.log("Log failed."),console.log(a)}})},mSQL.mainQueryBuild=function(a){"use strict";function b(){var a,b,c,d=[];return a=b=c="",d=mMaster.x.sql.joinKeyArray,b=mMaster.x.sql.centralTable,$.each(mMoreFilters.eachFilter,function(e,f){c=f.sql.subName,a+=f.sql.joinType+"( \n"+mSQL.indent(f.sql.query,"  ")+") "+f.sql.subName+" \n"+mSQL.createJoinOn(d,b,c)}),a=mSQL.indent(a,"  ")}function c(a){function b(a,b){return""!==b&&(b=a+"."+b),b}function c(a){return""!==a&&(a="and "+a),a}var d="";return d=c(a.x.sql.filter)+c(b(a.x.sql.subName,a.x.sql.filterRealistic))+c(a.y.sql.filter)+c(b(a.y.sql.subName,a.y.sql.filterRealistic))+c(b(mMaster.x.sql.centralTable,mMaster.sql.filterGrade)),$.each(mMoreFilters.eachFilter,function(a,e){d+=c(e.sql.filter),d+=c(b(e.sql.subName,e.sql.filterRealistic))}),d=mSQL.indent(d,"    ")}var d,e,f,g,h,i,j,k,l,m;d=e=f=g=h=i=j=k=l=m="";var n=a.x.sql.centralTable,o=a.x.sql.centralDB,p=a.x.sql.centralTableHeat;a.sql.filterGlobal;return e="left outer join"===a.x.sql.joinType?"isNull(subX."+a.x.sql.idFull+", 0) as x":"subX."+a.x.sql.idFull+" as x",f="left outer join"===a.y.sql.joinType?"isNull(subY."+a.y.sql.idFull+", 0) as y":"subY."+a.y.sql.idFull+" as y",g=n+"."+p+" as heat",null!==a.x.round&&"datetime"===a.x.type?(h="dateadd("+a.x.round+", datediff("+a.x.round+", 0, "+a.x.sql.idFull+"), 0) as roundX",i="avg(y) over(partition by roundX) as roundYavg",j="count(y) over(partition by roundX) as roundYcount",k="stdev(y) over(partition by roundX) as roundYstdev"):null!==a.x.round&&"linear"===a.x.type?(h=a.x.round+"*round("+a.x.sql.idFull+"/"+a.x.round+", 0) as roundX",i="avg(y) over(partition by roundX) as roundYavg",j="count(y) over(partition by roundX) as roundYcount",k="stdev(y) over(partition by roundX) as roundYstdev"):(h="null as roundX",i="null as roundYavg",j="null as roundYcount",k="null as roundYstdev"),a.x.sql.query=mSQL.indent(a.x.sql.query,"    "),a.y.sql.query=mSQL.indent(a.y.sql.query,"    "),m=b(),l=c(a),d="select \n  x, y, heat, roundX, "+i+", "+j+", "+k+" \nfrom( \n  select distinct \n    "+e+", "+f+", "+g+", "+h+" \n  from "+o+"."+n+" "+n+" \n  "+a.x.sql.joinType+"( \n"+a.x.sql.query+"  ) subX \n    on bop_ht.ht_num = subX.ht_num \n      and bop_ht.tap_yr = subX.tap_yr \n  "+a.y.sql.joinType+"( \n"+a.y.sql.query+"  ) subY \n    on bop_ht.ht_num = subY.ht_num \n      and bop_ht.tap_yr = subY.tap_yr \n"+m+"  where "+mMaster.sql.filterDate+l+") sub \nwhere \n  x is not null \n  and y is not null \norder by x asc"},mSQL.subQueryBuild=function(a,b,c){"use strict";void 0===c?c=1:c+=1;var d,e,f,g,h,i,j,k,l;d=e=f=g=h=i=j=k=l="";var m=!1,n=[],o=[],p=[],q=[],r=[],s=null,t={},u={},v=null;return r=a.fieldWrapDelete().split(" "),j=r[0],p=[],$.each(r,function(a,b){a>0&&p.push(b)}),q=p,t=getDefinitions(j,p,q),g=t.sql.field,m=t.sql.fromOverride,v=t.sql.selectDistinct?"select distinct":"select",n=g.fieldWrapToArray(),s=n.length>0?!0:!1,m?(i=null,f=mSQL.createSelectPrefix(t.sql.joinKeyArray,i),d=v+" "+f+", "+t.sql.field+" as "+a+" \nfrom( \n"+m+") sub \nwhere "+b,""!==t.sql.filterLocal&&(d+=t.sql.filterLocal)):1===c&&s===!1?(i=null,f=mSQL.createSelectPrefix(t.sql.joinKeyArray,i),d=v+" "+f+", "+t.sql.field+" as "+a+" \nfrom "+t.sql.db+"."+t.sql.table+" "+t.sql.table+" \nwhere "+b,""!==t.sql.filterLocal&&(d+=t.sql.filterLocal)):s===!0?(i="sub1",f=mSQL.createSelectPrefix(t.sql.joinKeyArray,i),d=v+" "+f+", "+t.sql.field+" as "+a+" \nfrom( \n",u=t.sql,$.each(n,function(a,f){r=f.fieldWrapDelete().split(" "),j=r[0],p=[],$.each(r,function(a,b){a>0&&p.push(b)}),q=p,i="sub"+(a+1),t=getDefinitions(j,p,null),e=mSQL.subQueryBuild(f,b,c).sql.query,e=mSQL.indent(e,"  "),0===a?(k="",l=""):(k=t.sql.joinType+"( \n",l=mSQL.createJoinOn(t.sql.joinKeyArray,"sub1",i)),o.push(t.sql.filterRealistic),d+=k+e+") "+i+" \n"+l}),$.each(o,function(a,b){i="sub"+(a+1),b.length>0&&(h+="where"!==h.substr(0,5)?"where \n  ":"  and ",h+=i+"."+b)}),t.sql=u,d+=h):c>1&&s===!1&&(i=null,f=mSQL.createSelectPrefix(t.sql.joinKeyArray,i),d=v+" "+f+", "+t.sql.field+" as "+a+" \nfrom "+t.sql.db+"."+t.sql.table+" "+t.sql.table+" \nwhere "+b,""!==t.sql.filterLocal&&(d+=t.sql.filterLocal)),t.sql.query=d,t},mSQL.createSelectPrefix=function(a,b){"juse strict";var c="";return 0===a.length?c:($.each(a,function(d,e){c+=null===b?e:b+"."+e,d!==a.length-1&&(c+=", ")}),c)},mSQL.createJoinOn=function(a,b,c){"use strict";var d="";return 0===a.length?d:(d+="  on ",$.each(a,function(a,e){a>0&&(d+="    and "),d+=b+"."+e+" = "+c+"."+e+" \n"}),d)},mSQL.indent=function(a,b){"use strict";if(""===a)return a;var c=a.split("\n");return a="",1===c.length?a=b+c[0]+"\n":$.each(c,function(d,e){d<c.length-1&&(a+=b+e+"\n")}),a},mSQL.createSingleFilter=function(a,b,c,d,e,f){"use strict";var g="";switch(b="left outer join"===f?"isNull("+a+"."+b+", 0)":a+"."+b,c){case null:g="",g=d&&e?b+" between '"+d+"' and '"+e+"' \n":d?b+" >= '"+d+"' \n":e?b+" <= '"+e+"' \n":"";break;case"between":g=b+" between '"+d+"' and '"+e+"' \n";break;case"notBetween":g=b+" not between '"+d+"' and '"+e+"' \n";break;case">":g=b+" > '"+d+"' \n";break;case"<":g=b+" < '"+d+"' \n";break;case">=":g=b+" >= '"+d+"' \n";break;case"<=":g=b+" <= '"+d+"' \n";break;case"=":g=b+" = '"+d+"' \n";break;case"!=":g=b+" != '"+d+"' \n"}return g},mUpdateAxes.start=function(){"use strict";function a(){$("#m-updateAxes #updateAxes").click(function(){mUpdateAxes.submitHandle()})}return mUpdateAxes.initialize(),a(),!0},mUpdateAxes.initialize=function(){"use strict";return mUpdateAxes.x={min:null,max:null},mUpdateAxes.y={min:null,max:null},!0},mUpdateAxes.submitHandle=function(){"use strict";return mUpdateAxes.getFromDOM(),mUpdateAxes.updateChart(),!0},mUpdateAxes.getFromDOM=function(){"use strict";var a=mMaster.x.type,b=nullIfBlank($("#m-updateAxes .xAxis .min").val()),c=nullIfBlank($("#m-updateAxes .xAxis .max").val()),d=nullIfBlank($("#m-updateAxes .yAxis .min").val()),e=nullIfBlank($("#m-updateAxes .yAxis .max").val());return"datetime"===a&&(b&&(b=Date.parse(b)),c&&(c=Date.parse(c))),mUpdateAxes.x.min=b,mUpdateAxes.x.max=c,mUpdateAxes.y.min=d,mUpdateAxes.y.max=e,!0},mUpdateAxes.updateChart=function(){"use strict";var a=$("#m-graph").highcharts(),b=mUpdateAxes.x.min,c=mUpdateAxes.x.max,d=mUpdateAxes.y.min,e=mUpdateAxes.y.max;return console.log(mUpdateAxes),a.xAxis[0].setExtremes(b,c),a.yAxis[0].setExtremes(d,e),!0},mUpdateSeries.start=function(){"use strict";function a(){$("#m-updateSeries #toggleVisibility").click(function(){mUpdateSeries.toggleVisibility()})}return a(),!0},mUpdateSeries.initialize=function(){"use strict";return!0},mUpdateSeries.submitHandle=function(){"use strict";return!0},mUpdateSeries.getFromDOM=function(){"use strict";return!0},mUpdateSeries.toggleVisibility=function(){"use strict";var a=$("#m-graph").highcharts(),b=.4,c=a.series[0].color,d=c.split(","),e=d[0]+","+d[1]+","+d[2],f=d[d.length-1];return"rgba"!==c.substring(0,4)?!1:(f=f.substring(0,f.length-1),f=parseFloat(f,2),f=1>f?1:b,c=e+","+f+")",a.series[0].update({color:c}),!0)};
//# sourceMappingURL=main.min.js.map